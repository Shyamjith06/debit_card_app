node {
     
  stage('Git-Checkout') {
   sh 'rm -rf user-project-application'
   sh 'git clone -b Testing https://Shyam_6@bitbucket.org/accelerators-devops/user-project-application.git'
  }
    
 def project_path="user-project-application/project_code"
 
 dir(project_path) {
    
  stage('Maven-Clean') {
   sh label: '', script: 'mvn clean'
  }
    
stage('Maven-Compile') {
   sh label: '', script: 'mvn compile'
  }

stage('Sonar Analysis'){
withSonarQubeEnv('SonarQube')
{ 
sh 'mvn sonar:sonar'
}
}
  

   stage('Maven-Test') {
   sh label: '', script: 'mvn test'
  }

  
   stage('Maven-Package') {
   sh label: '', script: 'mvn package'
  }
   }   
def playbook_path="user-project-application/Ansible"
dir(playbook_path) {
stage('Ansible Playbook Execution') {
sh label: 'Ansible', script: 'ansible-playbook -i inventory -u testing playbook.yml'
}
}
}